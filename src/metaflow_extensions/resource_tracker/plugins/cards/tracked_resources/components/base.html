<html>
<head>
    <script type="text/javascript">{{{dygraphs_js}}}</script>
    <script type="text/javascript">{{{dygraphs_crosshair_js}}}</script>
    <script type="text/javascript">{{{dygraphs_synchronizer_js}}}</script>
    <style type="text/css">{{{dygraphs_css}}}</style>
    <script type="text/javascript">{{{helpers_js}}}</script>
    <style type="text/css">{{{custom_css}}}</style>
</head>
<body>
    <div id="cpu" class="section">
        <h1>
            <div class="header-icon">
                {{{icon_cpu}}}
            </div>
            <div class="header-text">
                <div class="title">CPU Usage</div>
                <p class="description">Both system-wide and task-wide CPU usage is measured by summing up the user+nice and system CPU times (in clock ticks), normalized to utilized CPU count by dividing by the total elapsed time * ticks per second. Task CPU usage includes all children processes.</p>
            </div>
            <div id="labels_cpu" class="labels"></div>
        </h1>
        <div id="plot_cpu" class="plot"></div>
    </div>
    <div id="mem" class="section">
        <h1 class="section-header">
            <div class="header-icon">
                {{{icon_memory}}}
            </div>
            <div class="header-text">
                <div class="title">Memory Usage</div>
                <p class="description">System-wide application memory usage is tracked via the size of anonymous memory pages, while task memory usage measured by summing up all Proportional Set Size (PSS) rollups of all subprocesses.</p>
            </div>
            <div id="labels_mem" class="labels"></div>
        </h1>
        <div id="plot_mem" class="plot"></div>
    </div>
    <div id="disk" class="section">
        <h1 class="section-header">
            <div class="header-icon">
                {{{icon_disk}}}
            </div>
            <div class="header-text">
                <div class="title">Disk Usage</div>
                <p class="description">Tracking task-specific disk usage is highly unreliable, so monitoring the system-wide disk usage is recommended, which includes all disks mounted on the system.</p>
            </div>
            <div id="labels_disk" class="labels"></div>
        </h1>
        <div id="plot_disk" class="plot"></div>
    </div>
    <script type="text/javascript">
        Dygraph.onDOMready(function onDOMready() {
            var cpuGraph = createGraph("plot_cpu", `{{{csv_cpu}}}`, 'labels_cpu'),
                memGraph = createGraph("plot_mem", `{{{csv_mem}}}`, 'labels_mem', { labelsKMG2: true }),
                diskGraph = createGraph("plot_disk", `{{{csv_disk}}}`, 'labels_disk',
                { 
                    labelsKMG2: true,
                    series: {
                        "Task disk write": {strokePattern: [7, 3], color: '#34D399'},
                        "System disk write": {strokePattern: [7, 3], color: '#38BDF8'},
                        "Task disk read": {strokePattern: null, color: '#34D399'},
                        "System disk read": {strokePattern: null, color: '#38BDF8'}
                    },
                });
            var sync = Dygraph.synchronize([cpuGraph, memGraph, diskGraph], {zoom: true, selection: true, range: false});
        });
    </script>
</body>
</html>